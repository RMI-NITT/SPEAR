var MersenneTwister=function(a){void 0==a&&(a=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(a)};MersenneTwister.prototype.init_genrand=function(a){for(this.mt[0]=a>>>0,this.mti=1;this.mti<this.N;this.mti++){var b=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&b)>>>16)<<16)+1812433253*(65535&b)+this.mti,this.mt[this.mti]>>>=0}},MersenneTwister.prototype.init_by_array=function(a,b){var c,d,e,f;for(this.init_genrand(19650218),c=1,d=0,e=this.N>b?this.N:b;e;e--)f=this.mt[c-1]^this.mt[c-1]>>>30,this.mt[c]=(this.mt[c]^(1664525*((4294901760&f)>>>16)<<16)+1664525*(65535&f))+a[d]+d,this.mt[c]>>>=0,c++,d++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1),d>=b&&(d=0);for(e=this.N-1;e;e--)f=this.mt[c-1]^this.mt[c-1]>>>30,this.mt[c]=(this.mt[c]^(1566083941*((4294901760&f)>>>16)<<16)+1566083941*(65535&f))-c,this.mt[c]>>>=0,c++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1);this.mt[0]=2147483648},MersenneTwister.prototype.genrand_int32=function(){var a,b=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var c;for(this.mti==this.N+1&&this.init_genrand(5489),c=0;c<this.N-this.M;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+this.M]^a>>>1^b[1&a];for(;c<this.N-1;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+(this.M-this.N)]^a>>>1^b[1&a];a=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^a>>>1^b[1&a],this.mti=0}return a=this.mt[this.mti++],a^=a>>>11,a^=a<<7&2636928640,a^=a<<15&4022730752,a^=a>>>18,a>>>0},MersenneTwister.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},MersenneTwister.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},MersenneTwister.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},MersenneTwister.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},MersenneTwister.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(67108864*a+b)*(1/9007199254740992)},function(a,b){"object"==typeof exports?module.exports=b(global):"function"==typeof define&&define.amd?define([],function(){return b(a)}):b(a)}(this,function(a){"use strict";function b(a){return f=a}function c(){return f="undefined"!=typeof Float32Array?Float32Array:Array}var d=1e-6,e={};!function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),b=new Int32Array(a.buffer);e.invsqrt=function(c){var d=.5*c;a[0]=c;var e=1.5;b[0]=1597463007-(b[0]>>1);var f=a[0];return f*(e-d*f*f)}}else e.invsqrt=function(a){return 1/Math.sqrt(a)}}();var f=null;c();var g={};g.create=function(a){var b=new f(3);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0,b},g.createFrom=function(a,b,c){var d=new f(3);return d[0]=a,d[1]=b,d[2]=c,d},g.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},g.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d},g.add=function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a)},g.subtract=function(a,b,c){return c&&a!==c?(c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c):(a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a)},g.multiply=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c):(a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a)},g.negate=function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b},g.scale=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a)},g.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);return f?1===f?(b[0]=c,b[1]=d,b[2]=e,b):(f=1/f,b[0]=c*f,b[1]=d*f,b[2]=e*f,b):(b[0]=0,b[1]=0,b[2]=0,b)},g.cross=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2];return c[0]=e*i-f*h,c[1]=f*g-d*i,c[2]=d*h-e*g,c},g.length=function(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)},g.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d},g.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},g.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1],f=a[2]-b[2],g=Math.sqrt(d*d+e*e+f*f);return g?(g=1/g,c[0]=d*g,c[1]=e*g,c[2]=f*g,c):(c[0]=0,c[1]=0,c[2]=0,c)},g.lerp=function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d},g.dist=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};var h=null,i=new f(4);g.unproject=function(a,b,c,d,e){e||(e=a),h||(h=o.create());var f=h,g=i;return g[0]=2*(a[0]-d[0])/d[2]-1,g[1]=2*(a[1]-d[1])/d[3]-1,g[2]=2*a[2]-1,g[3]=1,o.multiply(c,b,f),o.inverse(f)?(o.multiplyVec4(f,g),0===g[3]?null:(e[0]=g[0]/g[3],e[1]=g[1]/g[3],e[2]=g[2]/g[3],e)):null};var j=g.createFrom(1,0,0),k=g.createFrom(0,1,0),l=g.createFrom(0,0,1),m=g.create();g.rotationTo=function(a,b,c){c||(c=p.create());var d=g.dot(a,b),e=m;if(d>=1)p.set(q,c);else if(1e-6-1>d)g.cross(j,a,e),g.length(e)<1e-6&&g.cross(k,a,e),g.length(e)<1e-6&&g.cross(l,a,e),g.normalize(e),p.fromAngleAxis(Math.PI,e,c);else{var f=Math.sqrt(2*(1+d)),h=1/f;g.cross(a,b,e),c[0]=e[0]*h,c[1]=e[1]*h,c[2]=e[2]*h,c[3]=.5*f,p.normalize(c)}return c[3]>1?c[3]=1:c[3]<-1&&(c[3]=-1),c},g.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"},g.distanceSquared=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e},g.setXYZ=function(a,b,c,d){return d[0]=a,d[1]=b,d[2]=c,d},g.linComb=function(a,b,c,d,e){return e||(e=a),e[0]=a[0]*b+c[0]*d,e[1]=a[1]*b+c[1]*d,e[2]=a[2]*b+c[2]*d,e},g.getAPerpendicularVector=function(a){var b=a[0],c=a[1];return Math.abs(b)<btTs.graphics.math.Tolerances.ZERO_LENGTH&&Math.abs(c)<btTs.graphics.math.Tolerances.ZERO_LENGTH?g.createFrom(1,0,0):g.createFrom(-c,b,0)};var n={};n.create=function(a){var b=new f(9);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0,b},n.createFrom=function(a,b,c,d,e,g,h,i,j){var k=new f(9);return k[0]=a,k[1]=b,k[2]=c,k[3]=d,k[4]=e,k[5]=g,k[6]=h,k[7]=i,k[8]=j,k},n.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*(j*f-g*i)+c*(-j*e+g*h)+d*(i*e-f*h)},n.inverse=function(a,b){var c,d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=l*h-i*k,o=-l*g+i*j,p=k*g-h*j,q=d*m+e*o+f*p;return q?(c=1/q,b||(b=n.create()),b[0]=m*c,b[1]=(-l*e+f*k)*c,b[2]=(i*e-f*h)*c,b[3]=o*c,b[4]=(l*d-f*j)*c,b[5]=(-i*d+f*g)*c,b[6]=p*c,b[7]=(-k*d+e*j)*c,b[8]=(h*d-e*g)*c,b):null},n.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=b[0],n=b[1],o=b[2],p=b[3],q=b[4],r=b[5],s=b[6],t=b[7],u=b[8];return c[0]=m*d+n*g+o*j,c[1]=m*e+n*h+o*k,c[2]=m*f+n*i+o*l,c[3]=p*d+q*g+r*j,c[4]=p*e+q*h+r*k,c[5]=p*f+q*i+r*l,c[6]=s*d+t*g+u*j,c[7]=s*e+t*h+u*k,c[8]=s*f+t*i+u*l,c},n.multiplyVec2=function(a,b,c){c||(c=b);var d=b[0],e=b[1];return c[0]=d*a[0]+e*a[3]+a[6],c[1]=d*a[1]+e*a[4]+a[7],c},n.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];return c[0]=d*a[0]+e*a[3]+f*a[6],c[1]=d*a[1]+e*a[4]+f*a[7],c[2]=d*a[2]+e*a[5]+f*a[8],c},n.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},n.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d&&Math.abs(a[3]-b[3])<d&&Math.abs(a[4]-b[4])<d&&Math.abs(a[5]-b[5])<d&&Math.abs(a[6]-b[6])<d&&Math.abs(a[7]-b[7])<d&&Math.abs(a[8]-b[8])<d},n.identity=function(a){return a||(a=n.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},n.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[5];return a[1]=a[3],a[2]=a[6],a[3]=c,a[5]=a[7],a[6]=d,a[7]=e,a}return b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8],b},n.toMat4=function(a,b){return b||(b=o.create()),b[15]=1,b[14]=0,b[13]=0,b[12]=0,b[11]=0,b[10]=a[8],b[9]=a[7],b[8]=a[6],b[7]=0,b[6]=a[5],b[5]=a[4],b[4]=a[3],b[3]=0,b[2]=a[2],b[1]=a[1],b[0]=a[0],b},n.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};var o={};o.create=function(a){var b=new f(16);return a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]),b},o.createFrom=function(a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q){var r=new f(16);return r[0]=a,r[1]=b,r[2]=c,r[3]=d,r[4]=e,r[5]=g,r[6]=h,r[7]=i,r[8]=j,r[9]=k,r[10]=l,r[11]=m,r[12]=n,r[13]=o,r[14]=p,r[15]=q,r},o.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},o.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d&&Math.abs(a[3]-b[3])<d&&Math.abs(a[4]-b[4])<d&&Math.abs(a[5]-b[5])<d&&Math.abs(a[6]-b[6])<d&&Math.abs(a[7]-b[7])<d&&Math.abs(a[8]-b[8])<d&&Math.abs(a[9]-b[9])<d&&Math.abs(a[10]-b[10])<d&&Math.abs(a[11]-b[11])<d&&Math.abs(a[12]-b[12])<d&&Math.abs(a[13]-b[13])<d&&Math.abs(a[14]-b[14])<d&&Math.abs(a[15]-b[15])<d},o.identity=function(a){return a||(a=o.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.transpose=function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];return a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=c,a[6]=a[9],a[7]=a[13],a[8]=d,a[9]=f,a[11]=a[14],a[12]=e,a[13]=g,a[14]=h,a}return b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15],b},o.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15];return n*k*h*e-j*o*h*e-n*g*l*e+f*o*l*e+j*g*p*e-f*k*p*e-n*k*d*i+j*o*d*i+n*c*l*i-b*o*l*i-j*c*p*i+b*k*p*i+n*g*d*m-f*o*d*m-n*c*h*m+b*o*h*m+f*c*p*m-b*g*p*m-j*g*d*q+f*k*d*q+j*c*h*q-b*k*h*q-f*c*l*q+b*g*l*q},o.inverse=function(a,b){b||(b=a);var c,d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14],s=a[15],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,F=t*E-u*D+v*C+w*B-x*A+y*z;return F?(c=1/F,b[0]=(i*E-j*D+k*C)*c,b[1]=(-e*E+f*D-g*C)*c,b[2]=(q*y-r*x+s*w)*c,b[3]=(-m*y+n*x-o*w)*c,b[4]=(-h*E+j*B-k*A)*c,b[5]=(d*E-f*B+g*A)*c,b[6]=(-p*y+r*v-s*u)*c,b[7]=(l*y-n*v+o*u)*c,b[8]=(h*D-i*B+k*z)*c,b[9]=(-d*D+e*B-g*z)*c,b[10]=(p*x-q*v+s*t)*c,b[11]=(-l*x+m*v-o*t)*c,b[12]=(-h*C+i*A-j*z)*c,b[13]=(d*C-e*A+f*z)*c,b[14]=(-p*w+q*u-r*t)*c,b[15]=(l*w-m*u+n*t)*c,b):null},o.toRotationMat=function(a,b){return b||(b=o.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},o.toMat3=function(a,b){return b||(b=n.create()),b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[4],b[4]=a[5],b[5]=a[6],b[6]=a[8],b[7]=a[9],b[8]=a[10],b},o.toInverseMat3=function(a,b){var c,d=a[0],e=a[1],f=a[2],g=a[4],h=a[5],i=a[6],j=a[8],k=a[9],l=a[10],m=l*h-i*k,o=-l*g+i*j,p=k*g-h*j,q=d*m+e*o+f*p;return q?(c=1/q,b||(b=n.create()),b[0]=m*c,b[1]=(-l*e+f*k)*c,b[2]=(i*e-f*h)*c,b[3]=o*c,b[4]=(l*d-f*j)*c,b[5]=(-i*d+f*g)*c,b[6]=p*c,b[7]=(-k*d+e*j)*c,b[8]=(h*d-e*g)*c,b):null},o.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14],s=a[15],t=b[0],u=b[1],v=b[2],w=b[3];return c[0]=t*d+u*h+v*l+w*p,c[1]=t*e+u*i+v*m+w*q,c[2]=t*f+u*j+v*n+w*r,c[3]=t*g+u*k+v*o+w*s,t=b[4],u=b[5],v=b[6],w=b[7],c[4]=t*d+u*h+v*l+w*p,c[5]=t*e+u*i+v*m+w*q,c[6]=t*f+u*j+v*n+w*r,c[7]=t*g+u*k+v*o+w*s,t=b[8],u=b[9],v=b[10],w=b[11],c[8]=t*d+u*h+v*l+w*p,c[9]=t*e+u*i+v*m+w*q,c[10]=t*f+u*j+v*n+w*r,c[11]=t*g+u*k+v*o+w*s,t=b[12],u=b[13],v=b[14],w=b[15],c[12]=t*d+u*h+v*l+w*p,c[13]=t*e+u*i+v*m+w*q,c[14]=t*f+u*j+v*n+w*r,c[15]=t*g+u*k+v*o+w*s,c},o.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];return c[0]=a[0]*d+a[4]*e+a[8]*f+a[12],c[1]=a[1]*d+a[5]*e+a[9]*f+a[13],c[2]=a[2]*d+a[6]*e+a[10]*f+a[14],c},o.multiplyVec4=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2],g=b[3];return c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*g,c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*g,c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*g,c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*g,c},o.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=b[0],q=b[1],r=b[2];return c&&a!==c?(d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],c[0]=d,c[1]=e,c[2]=f,c[3]=g,c[4]=h,c[5]=i,c[6]=j,c[7]=k,c[8]=l,c[9]=m,c[10]=n,c[11]=o,c[12]=d*p+h*q+l*r+a[12],c[13]=e*p+i*q+m*r+a[13],c[14]=f*p+j*q+n*r+a[14],c[15]=g*p+k*q+o*r+a[15],c):(a[12]=a[0]*p+a[4]*q+a[8]*r+a[12],a[13]=a[1]*p+a[5]*q+a[9]*r+a[13],a[14]=a[2]*p+a[6]*q+a[10]*r+a[14],a[15]=a[3]*p+a[7]*q+a[11]*r+a[15],a)},o.scale=function(a,b,c){var d=b[0],e=b[1],f=b[2];return c&&a!==c?(c[0]=a[0]*d,c[1]=a[1]*d,c[2]=a[2]*d,c[3]=a[3]*d,c[4]=a[4]*e,c[5]=a[5]*e,c[6]=a[6]*e,c[7]=a[7]*e,c[8]=a[8]*f,c[9]=a[9]*f,c[10]=a[10]*f,c[11]=a[11]*f,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c):(a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=f,a[9]*=f,a[10]*=f,a[11]*=f,a)},o.rotate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c[0],D=c[1],E=c[2],F=Math.sqrt(C*C+D*D+E*E);return F?(1!==F&&(F=1/F,C*=F,D*=F,E*=F),e=Math.sin(b),f=Math.cos(b),g=1-f,h=a[0],i=a[1],j=a[2],k=a[3],l=a[4],m=a[5],n=a[6],o=a[7],p=a[8],q=a[9],r=a[10],s=a[11],t=C*C*g+f,u=D*C*g+E*e,v=E*C*g-D*e,w=C*D*g-E*e,x=D*D*g+f,y=E*D*g+C*e,z=C*E*g+D*e,A=D*E*g-C*e,B=E*E*g+f,d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a,d[0]=h*t+l*u+p*v,d[1]=i*t+m*u+q*v,d[2]=j*t+n*u+r*v,d[3]=k*t+o*u+s*v,d[4]=h*w+l*x+p*y,d[5]=i*w+m*x+q*y,d[6]=j*w+n*x+r*y,d[7]=k*w+o*x+s*y,d[8]=h*z+l*A+p*B,d[9]=i*z+m*A+q*B,d[10]=j*z+n*A+r*B,d[11]=k*z+o*A+s*B,d):null},o.rotateX=function(a,b,c){var d=Math.sin(b),e=Math.cos(b),f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11];return c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[4]=f*e+j*d,c[5]=g*e+k*d,c[6]=h*e+l*d,c[7]=i*e+m*d,c[8]=f*-d+j*e,c[9]=g*-d+k*e,c[10]=h*-d+l*e,c[11]=i*-d+m*e,c},o.rotateY=function(a,b,c){var d=Math.sin(b),e=Math.cos(b),f=a[0],g=a[1],h=a[2],i=a[3],j=a[8],k=a[9],l=a[10],m=a[11];return c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=f*e+j*-d,c[1]=g*e+k*-d,c[2]=h*e+l*-d,c[3]=i*e+m*-d,c[8]=f*d+j*e,c[9]=g*d+k*e,c[10]=h*d+l*e,c[11]=i*d+m*e,c},o.rotateZ=function(a,b,c){var d=Math.sin(b),e=Math.cos(b),f=a[0],g=a[1],h=a[2],i=a[3],j=a[4],k=a[5],l=a[6],m=a[7];return c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a,c[0]=f*e+j*d,c[1]=g*e+k*d,c[2]=h*e+l*d,c[3]=i*e+m*d,c[4]=f*-d+j*e,c[5]=g*-d+k*e,c[6]=h*-d+l*e,c[7]=i*-d+m*e,c},o.frustum=function(a,b,c,d,e,f,g){g||(g=o.create());var h=b-a,i=d-c,j=f-e;return g[0]=2*e/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*e/i,g[6]=0,g[7]=0,g[8]=(b+a)/h,g[9]=(d+c)/i,g[10]=-(f+e)/j,g[11]=-1,g[12]=0,g[13]=0,g[14]=-(f*e*2)/j,g[15]=0,g},o.perspective=function(a,b,c,d,e){var f=c*Math.tan(a*Math.PI/360),g=f*b;return o.frustum(-g,g,-f,f,c,d,e)},o.ortho=function(a,b,c,d,e,f,g){g||(g=o.create());var h=b-a,i=d-c,j=f-e;return g[0]=2/h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2/i,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=-2/j,g[11]=0,g[12]=-(a+b)/h,g[13]=-(d+c)/i,g[14]=-(f+e)/j,g[15]=1,g},o.lookAt=function(a,b,c,d){d||(d=o.create());var e,f,g,h,i,j,k,l,m,n,p=a[0],q=a[1],r=a[2],s=c[0],t=c[1],u=c[2],v=b[0],w=b[1],x=b[2];return p===v&&q===w&&r===x?o.identity(d):(k=p-v,l=q-w,m=r-x,n=1/Math.sqrt(k*k+l*l+m*m),k*=n,l*=n,m*=n,e=t*m-u*l,f=u*k-s*m,g=s*l-t*k,n=Math.sqrt(e*e+f*f+g*g),n?(n=1/n,e*=n,f*=n,g*=n):(e=0,f=0,g=0),h=l*g-m*f,i=m*e-k*g,j=k*f-l*e,n=Math.sqrt(h*h+i*i+j*j),n?(n=1/n,h*=n,i*=n,j*=n):(h=0,i=0,j=0),d[0]=e,d[1]=h,d[2]=k,d[3]=0,d[4]=f,d[5]=i,d[6]=l,d[7]=0,d[8]=g,d[9]=j,d[10]=m,d[11]=0,d[12]=-(e*p+f*q+g*r),d[13]=-(h*p+i*q+j*r),d[14]=-(k*p+l*q+m*r),d[15]=1,d)},o.fromRotationTranslation=function(a,b,c){c||(c=o.create());var d=a[0],e=a[1],f=a[2],g=a[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,p=e*j,q=f*j,r=g*h,s=g*i,t=g*j;return c[0]=1-(n+q),c[1]=l+t,c[2]=m-s,c[3]=0,c[4]=l-t,c[5]=1-(k+q),c[6]=p+r,c[7]=0,c[8]=m+s,c[9]=p-r,c[10]=1-(k+n),c[11]=0,c[12]=b[0],c[13]=b[1],c[14]=b[2],c[15]=1,c},o.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};var p={};p.create=function(a){var b=new f(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},p.createFrom=function(a,b,c,d){var e=new f(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},p.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},p.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d&&Math.abs(a[3]-b[3])<d},p.identity=function(a){return a||(a=p.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};var q=p.identity();p.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];return b&&a!==b?(b[0]=c,b[1]=d,b[2]=e,b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),b):(a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a)},p.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},p.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=c*c+d*d+e*e+f*f,h=g?1/g:0;return b&&a!==b?(b[0]=-a[0]*h,b[1]=-a[1]*h,b[2]=-a[2]*h,b[3]=a[3]*h,b):(a[0]*=-h,a[1]*=-h,a[2]*=-h,a[3]*=h,a)},p.conjugate=function(a,b){return b&&a!==b?(b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=a[3],b):(a[0]*=-1,a[1]*=-1,a[2]*=-1,a)},p.length=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)},p.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=Math.sqrt(c*c+d*d+e*e+f*f);return 0===g?(b[0]=0,b[1]=0,b[2]=0,b[3]=0,b):(g=1/g,b[0]=c*g,b[1]=d*g,b[2]=e*g,b[3]=f*g,b)},p.add=function(a,b,c){return c&&a!==c?(c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c):(a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a)},p.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=b[0],i=b[1],j=b[2],k=b[3];return c[0]=d*k+g*h+e*j-f*i,c[1]=e*k+g*i+f*h-d*j,c[2]=f*k+g*j+d*i-e*h,c[3]=g*k-d*h-e*i-f*j,c},p.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2],g=a[0],h=a[1],i=a[2],j=a[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return c[0]=k*j+n*-g+l*-i-m*-h,c[1]=l*j+n*-h+m*-g-k*-i,c[2]=m*j+n*-i+k*-h-l*-g,c},p.scale=function(a,b,c){return c&&a!==c?(c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c):(a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a)},p.toMat3=function(a,b){b||(b=n.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,o=d*i,p=e*i,q=f*g,r=f*h,s=f*i;return b[0]=1-(m+p),b[1]=k+s,b[2]=l-r,b[3]=k-s,b[4]=1-(j+p),b[5]=o+q,b[6]=l+r,b[7]=o-q,b[8]=1-(j+m),b},p.toMat4=function(a,b){b||(b=o.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,p=e*i,q=f*g,r=f*h,s=f*i;return b[0]=1-(m+p),b[1]=k+s,b[2]=l-r,b[3]=0,b[4]=k-s,b[5]=1-(j+p),b[6]=n+q,b[7]=0,b[8]=l+r,b[9]=n-q,b[10]=1-(j+m),b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},p.slerp=function(a,b,c,d){d||(d=a);var e,f,g,h,i=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3];return Math.abs(i)>=1?(d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d):(e=Math.acos(i),f=Math.sqrt(1-i*i),Math.abs(f)<.001?(d[0]=.5*a[0]+.5*b[0],d[1]=.5*a[1]+.5*b[1],d[2]=.5*a[2]+.5*b[2],d[3]=.5*a[3]+.5*b[3],d):(g=Math.sin((1-c)*e)/f,h=Math.sin(c*e)/f,d[0]=a[0]*g+b[0]*h,d[1]=a[1]*g+b[1]*h,d[2]=a[2]*g+b[2]*h,d[3]=a[3]*g+b[3]*h,d))},p.fromRotationMatrix=function(a,b){b||(b=p.create());var c,d=a[0]+a[4]+a[8];if(d>0)c=Math.sqrt(d+1),b[3]=.5*c,c=.5/c,b[0]=(a[7]-a[5])*c,b[1]=(a[2]-a[6])*c,b[2]=(a[3]-a[1])*c;else{var e=p.fromRotationMatrix.s_iNext=p.fromRotationMatrix.s_iNext||[1,2,0],f=0;a[4]>a[0]&&(f=1),a[8]>a[3*f+f]&&(f=2);var g=e[f],h=e[g];c=Math.sqrt(a[3*f+f]-a[3*g+g]-a[3*h+h]+1),b[f]=.5*c,c=.5/c,b[3]=(a[3*h+g]-a[3*g+h])*c,b[g]=(a[3*g+f]+a[3*f+g])*c,b[h]=(a[3*h+f]+a[3*f+h])*c}return b},n.toQuat4=p.fromRotationMatrix,function(){var a=n.create();p.fromAxes=function(b,c,d,e){return a[0]=c[0],a[3]=c[1],a[6]=c[2],a[1]=d[0],a[4]=d[1],a[7]=d[2],a[2]=b[0],a[5]=b[1],a[8]=b[2],p.fromRotationMatrix(a,e)}}(),p.identity=function(a){return a||(a=p.create()),a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},p.fromAngleAxis=function(a,b,c){c||(c=p.create());var d=.5*a,e=Math.sin(d);return c[3]=Math.cos(d),c[0]=e*b[0],c[1]=e*b[1],c[2]=e*b[2],c},p.toAngleAxis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];if(c>0){b[3]=2*Math.acos(a[3]);var d=e.invsqrt(c);b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d}else b[3]=0,b[0]=1,b[1]=0,b[2]=0;return b},p.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var r={};r.create=function(a){var b=new f(2);return a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0),b},r.createFrom=function(a,b){var c=new f(2);return c[0]=a,c[1]=b,c},r.add=function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c},r.subtract=function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c},r.multiply=function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c},r.divide=function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c},r.scale=function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c},r.dist=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},r.set=function(a,b){return b[0]=a[0],b[1]=a[1],b},r.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d},r.negate=function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b},r.normalize=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];return c>0?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0,b},r.cross=function(a,b,c){var d=a[0]*b[1]-a[1]*b[0];return c?(c[0]=c[1]=0,c[2]=d,c):d},r.length=function(a){var b=a[0],c=a[1];return Math.sqrt(b*b+c*c)},r.squaredLength=function(a){var b=a[0],c=a[1];return b*b+c*c},r.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]},r.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1],f=d*d+e*e;return f?(f=1/Math.sqrt(f),c[0]=d*f,c[1]=e*f,c):(c[0]=0,c[1]=0,c[2]=0,c)},r.lerp=function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d},r.str=function(a){return"["+a[0]+", "+a[1]+"]"},r.distanceSquared=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};var s={};s.create=function(a){var b=new f(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0,b},s.createFrom=function(a,b,c,d){var e=new f(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},s.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},s.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d&&Math.abs(a[3]-b[3])<d},s.identity=function(a){return a||(a=s.create()),a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},s.transpose=function(a,b){if(!b||a===b){var c=a[1];return a[1]=a[2],a[2]=c,a}return b[0]=a[0],b[1]=a[2],b[2]=a[1],b[3]=a[3],b},s.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},s.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=c*f-e*d;return g?(g=1/g,b[0]=f*g,b[1]=-d*g,b[2]=-e*g,b[3]=c*g,b):null},s.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3];return c[0]=d*b[0]+e*b[2],c[1]=d*b[1]+e*b[3],c[2]=f*b[0]+g*b[2],c[3]=f*b[1]+g*b[3],c},s.rotate=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=Math.sin(b),i=Math.cos(b);return c[0]=d*i+e*h,c[1]=d*-h+e*i,c[2]=f*i+g*h,c[3]=f*-h+g*i,c},s.multiplyVec2=function(a,b,c){c||(c=b);var d=b[0],e=b[1];return c[0]=d*a[0]+e*a[1],c[1]=d*a[2]+e*a[3],c},s.scale=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],h=b[0],i=b[1];return c[0]=d*h,c[1]=e*i,c[2]=f*h,c[3]=g*i,c},s.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var t={};return t.create=function(a){var b=new f(4);return a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0),b},t.createFrom=function(a,b,c,d){var e=new f(4);return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},t.add=function(a,b,c){return c||(c=b),c[0]=a[0]+b[0],c[1]=a[1]+b[1],c[2]=a[2]+b[2],c[3]=a[3]+b[3],c},t.subtract=function(a,b,c){return c||(c=b),c[0]=a[0]-b[0],c[1]=a[1]-b[1],c[2]=a[2]-b[2],c[3]=a[3]-b[3],c},t.multiply=function(a,b,c){return c||(c=b),c[0]=a[0]*b[0],c[1]=a[1]*b[1],c[2]=a[2]*b[2],c[3]=a[3]*b[3],c},t.divide=function(a,b,c){return c||(c=b),c[0]=a[0]/b[0],c[1]=a[1]/b[1],c[2]=a[2]/b[2],c[3]=a[3]/b[3],c},t.scale=function(a,b,c){return c||(c=a),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c[3]=a[3]*b,c},t.set=function(a,b){return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},t.equal=function(a,b){return a===b||Math.abs(a[0]-b[0])<d&&Math.abs(a[1]-b[1])<d&&Math.abs(a[2]-b[2])<d&&Math.abs(a[3]-b[3])<d},t.negate=function(a,b){return b||(b=a),b[0]=-a[0],b[1]=-a[1],b[2]=-a[2],b[3]=-a[3],b},t.length=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)},t.squaredLength=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e},t.lerp=function(a,b,c,d){return d||(d=a),d[0]=a[0]+c*(b[0]-a[0]),d[1]=a[1]+c*(b[1]-a[1]),d[2]=a[2]+c*(b[2]-a[2]),d[3]=a[3]+c*(b[3]-a[3]),d},t.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"},t.distanceSquared=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f},t.setXYZW=function(a,b,c,d,e){return e[0]=a,e[1]=b,e[2]=c,e[3]=d,e},a&&(a.glMatrixArrayType=f,a.MatrixArray=f,a.setMatrixArrayType=b,a.determineMatrixArrayType=c,a.glMath=e,a.vec2=r,a.vec3=g,a.vec4=t,a.mat2=s,a.mat3=n,a.mat4=o,a.quat4=p),{glMatrixArrayType:f,MatrixArray:f,setMatrixArrayType:b,determineMatrixArrayType:c,glMath:e,vec2:r,vec3:g,vec4:t,mat2:s,mat3:n,mat4:o,quat4:p}});